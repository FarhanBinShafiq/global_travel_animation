<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Travel Animation</title>
    <style>
        body {
            margin: 0;
            font-family: system-ui, sans-serif;
            background-color: #000010;
            color: white;
        }
        .container {
            width: 100vw;
            height: 100vh;
            cursor: grab;
        }
        .info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 10;
        }
        /* --- Style for the new footer --- */
        .footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
            padding: 15px 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
            z-index: 10;
        }
    </style>
</head>
<body>
    
    <div id="globeViz" class="container"></div>
    <div class="info">
        <h1>Global Travel Routes</h1>
        <p>Drag to explore. Hover over countries and points.</p>
    </div>

    <footer class="footer">
        Developed by Farhan
    </footer>

    <script src="//unpkg.com/three"></script>
    <script src="//unpkg.com/three/examples/js/loaders/GLTFLoader.js"></script>
    <script src="//unpkg.com/globe.gl"></script>
    <script src="//unpkg.com/topojson-client"></script>

    <script>
        // NOTE: This version of the script has loading issues. 
        // A corrected version using ES Modules was provided previously.

        // === 1. DATA SETUP ===
        const locations = {
            dhaka: { lat: 23.8103, lng: 90.4125, name: 'Dhaka ðŸ‡§ðŸ‡©' },
            stockholm: { lat: 59.3293, lng: 18.0686, name: 'Stockholm ðŸ‡¸ðŸ‡ª' },
            riyadh: { lat: 24.7136, lng: 46.6753, name: 'Riyadh ðŸ‡¸ðŸ‡¦' },
            newYork: { lat: 40.7128, lng: -74.0060, name: 'New York ðŸ‡ºðŸ‡¸' },
            sydney: { lat: -33.8688, lng: 151.2093, name: 'Sydney ðŸ‡¦ðŸ‡º' },
            tokyo: { lat: 35.6895, lng: 139.6917, name: 'Tokyo ðŸ‡¯ðŸ‡µ' },
            singaporePort: { lat: 1.2646, lng: 103.8358, name: 'Singapore Port ðŸ‡¸ðŸ‡¬' },
            rotterdamPort: { lat: 51.9225, lng: 4.47917, name: 'Rotterdam Port ðŸ‡³ðŸ‡±' },
            losAngelesPort: { lat: 33.7292, lng: -118.2620, name: 'Los Angeles Port ðŸ‡ºðŸ‡¸' }
        };
        const travelRoutes = [
            { start: locations.dhaka, end: locations.stockholm, type: 'flight' },
            { start: locations.stockholm, end: locations.riyadh, type: 'flight' },
            { start: locations.newYork, end: locations.tokyo, type: 'flight' },
            { start: locations.sydney, end: locations.newYork, type: 'flight' },
            { start: locations.singaporePort, end: locations.rotterdamPort, type: 'ship' },
            { start: locations.tokyo, end: locations.losAngelesPort, type: 'ship' }
        ];
        const arcsData = travelRoutes.map(route => ({
            startLat: route.start.lat,
            startLng: route.start.lng,
            endLat: route.end.lat,
            endLng: route.end.lng,
            color: route.type === 'flight' ? 'rgba(255, 255, 0, 0.6)' : 'rgba(0, 255, 255, 0.6)',
            stroke: route.type === 'flight' ? 0.3 : 0.4
        }));
        
        // === 2. 3D MODELS & GLOBE SETUP ===
        const planeModel = {
            url: 'https://unpkg.com/three-globe/example/objects/airplane.glb',
            scale: 0.008,
            altitude: 0.03,
            rotation: { x: Math.PI / 2, y: 0, z: 0 }
        };
        const shipModel = {
            url: 'https://assets.codepen.io/285018/boat-small.glb',
            scale: 0.015,
            altitude: 0,
            rotation: { x: Math.PI / 2, y: 0, z: Math.PI }
        };
        const movingObjectsData = [];
        let time = 0;

        const globe = Globe()
            (document.getElementById('globeViz'))
            .globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg')
            .bumpImageUrl('//unpkg.com/three-globe/example/img/earth-topology.png')
            .backgroundImageUrl('//unpkg.com/three-globe/example/img/night-sky.png')
            .atmosphereColor('rgba(60, 120, 200, 0.5)')
            .atmosphereAltitude(0.2)
            .pointsData(Object.values(locations))
            .pointColor(() => '#f8cdda')
            .pointAltitude(0.005)
            .pointRadius(0.3)
            .pointLabel('name')
            .arcsData(arcsData)
            .arcColor('color')
            .arcStroke('stroke')
            .arcDashLength(0.4)
            .arcDashGap(0.2)
            .arcDashAnimateTime(4000)
            .objectsData(movingObjectsData)
            .objectThreeObject(d => d.model)
            .objectLat(d => d.lat)
            .objectLng(d => d.lng)
            .objectAltitude(d => d.alt)
            .objectRotation(d => d.rotation)
            .objectFacesSurface(false);

        // === 3. COUNTRY POLYGONS & LABELS ===
        fetch('//unpkg.com/world-atlas/countries-110m.json')
            .then(res => res.json())
            .then(countries => {
                const geoJson = topojson.feature(countries, countries.objects.countries);
                globe.polygonsData(geoJson.features)
                    .polygonCapColor(() => 'rgba(0, 0, 0, 0)')
                    .polygonSideColor(() => 'rgba(255, 255, 255, 0.1)')
                    .polygonStrokeColor(() => '#6688cc')
                    .polygonLabel(({ properties: d }) => `<b>${d.ADMIN}</b>`);
            });

        // === 4. ANIMATION LOGIC ===
        const getArcPoint = (progress, startLat, startLng, endLat, endLng) => {
            const B = (t) => t * t * (3 - 2 * t);
            const t = B(progress);
            const lat = startLat + (endLat - startLat) * t;
            const lng = startLng + (endLng - startLng) * t;
            return { lat, lng };
        };
        
        (function animate() {
            time += 0.0003;
            movingObjectsData.length = 0;
            travelRoutes.forEach(route => {
                const progress = (time + Math.random()) % 1;
                const { lat, lng } = getArcPoint(progress, route.start.lat, route.start.lng, route.end.lat, route.end.lng);
                
                let model, alt;
                if(route.type === 'flight') {
                    model = new THREE.Object3D();
                    new THREE.GLTFLoader().load(planeModel.url, gltf => {
                       model.add(gltf.scene);
                    });
                    model.scale.set(planeModel.scale, planeModel.scale, planeModel.scale);
                    alt = planeModel.altitude * Math.sin(progress * Math.PI);
                } else {
                    model = new THREE.Object3D();
                    new THREE.GLTFLoader().load(shipModel.url, gltf => {
                       model.add(gltf.scene);
                    });
                    model.scale.set(shipModel.scale, shipModel.scale, shipModel.scale);
                    alt = shipModel.altitude;
                }
                movingObjectsData.push({
                    lat, lng, alt, model,
                    rotation: route.type === 'flight' ? planeModel.rotation : shipModel.rotation
                });
            });
            
            globe.objectsData(movingObjectsData);
            requestAnimationFrame(animate);
        })();

        // === 5. CAMERA CONTROLS ===
        globe.controls().autoRotate = true;
        globe.controls().autoRotateSpeed = 0.2;
        globe.controls().enableZoom = true;
        
        globe.pointOfView({ lat: 30, lng: 45, altitude: 2.5 }, 3000);

    </script>
</body>
</html>